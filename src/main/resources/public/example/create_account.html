<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF8">
    <meta name="viewport" content="width=350">
    <script src="jquery-3.3.1.min.js"></script>
    <link rel="stylesheet" href="sty.css">
</head>
<body>
    <div id="back">
        <header>
            <b>QR入退室管理</b>
        </header>
                
        <main>
            <h2>アカウント作成</h2>
            <form id="form_1" method="post" accept-charset="utf-8" return false>
                <p>ID:<input type="text" name="userid" id="userid"></p>
                <p>Name:<input type="text" name="nameVal" id="nameVal"></p>
                <p>パスワード:<input type="text" name="password" id="password"></p>
                    
                </form>
                <button id ="ajax">Create</button>
                <div class ="result"></div>
                <p id="ans"></p>
            
            </main>
    </div>
    





<script type="text/javascript">
            $(function(){

                $('#ajax').on('click', function(){
                console.log(location.href);
                    var JSONdata = {

                        "id": $('#userid').val(),
                        "name":$('#nameVal').val(),
                        "password": $('#password').val()

                    }

                    $.ajax({

                        type:'POST',
                        data:JSON.stringify(JSONdata),
                        dataType:'application/json',
                        url:'api/user/create'
                    })
                    .done((data) => {
                        /*$('#ans').html(data);
                        console.log(data.responseText);
                        var obj = JSON.parse(data.responseText)
                        console.log(obj.msg)
                        $('#ans').text(obj.msg)*/

                    })
                    .fail((data) => {
                        /*
                        $('#ans').html(data);
                        console.log(data.responseText);
                        var obj = JSON.parse(data.responseText)
                        console.log(obj.msg)
                        $('#ans').text(obj.msg)*/
                    })
                    .always((data) =>{
                        $('#ans').html(data);
                        console.log(data.responseText);
                        var obj = JSON.parse(data.responseText)
                        console.log(obj.msg)

                        if(obj.status == "ERROR"){
                            $('#ans').text("失敗しました入力内容をご確認の上再度送信してください")
                        }else{
                            console.log("")
                        }
                    });
                });
            });
        </script>

</body>
</html>

